#!/usr/bin/env node
!function(e){"use strict";var t,n=function(){return p.__string_rec(this,"")},s=s||{};class r{constructor(e,t){this.r=new RegExp(e,t.split("u").join(""))}match(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m}matched(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw _.thrown("EReg::matched")}}r.__name__=!0;class i{static cca(e,t){let n=e.charCodeAt(t);if(n==n)return n}static substr(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)}static now(){return Date.now()}}i.__name__=!0;class a{static fold(e,t,n){let s=oe(e);for(;s.hasNext();)n=t(s.next(),n);return n}static find(e,t){let n=oe(e);for(;n.hasNext();){let e=n.next();if(t(e))return e}return null}}a.__name__=!0,Math.__name__=!0;class l{static field(e,t){try{return e[t]}catch(e){return null}}}l.__name__=!0;class c{static string(e){return p.__string_rec(e,"")}}c.__name__=!0;class u{static isSpace(e,t){let n=i.cca(e,t);return n>8&&n<14||32==n}static ltrim(e){let t=e.length,n=0;for(;n<t&&u.isSpace(e,n);)++n;return n>0?i.substr(e,n,t-n):e}static rtrim(e){let t=e.length,n=0;for(;n<t&&u.isSpace(e,t-n-1);)++n;return n>0?i.substr(e,0,t-n):e}static trim(e){return u.ltrim(u.rtrim(e))}static lpad(e,t,n){if(t.length<=0)return e;let s="";for(n-=e.length;s.length<n;)s+=null==t?"null":""+t;return s+=null==e?"null":""+e,s}static replace(e,t,n){return e.split(t).join(n)}}u.__name__=!0;class o{static systemName(){let e=process.platform;switch(e){case"darwin":return"Mac";case"freebsd":return"BSD";case"linux":return"Linux";case"win32":return"Windows";default:return e}}}o.__name__=!0;var h=s["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:n},Module:(t=function(e){return{_hx_index:1,m:e,__enum__:"haxe.StackItem",toString:n}},t._hx_name="Module",t.__params__=["m"],t),FilePos:(t=function(e,t,s,r){return{_hx_index:2,s:e,file:t,line:s,column:r,__enum__:"haxe.StackItem",toString:n}},t._hx_name="FilePos",t.__params__=["s","file","line","column"],t),Method:(t=function(e,t){return{_hx_index:3,classname:e,method:t,__enum__:"haxe.StackItem",toString:n}},t._hx_name="Method",t.__params__=["classname","method"],t),LocalFunction:(t=function(e){return{_hx_index:4,v:e,__enum__:"haxe.StackItem",toString:n}},t._hx_name="LocalFunction",t.__params__=["v"],t)};h.__constructs__=[h.CFunction,h.Module,h.FilePos,h.Method,h.LocalFunction];class _ extends Error{constructor(e,t,n){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=n?n:this}unwrap(){return this.__nativeException}get_native(){return this.__nativeException}static caught(e){return e instanceof _?e:e instanceof Error?new _(e.message,null,e):new d(e,null,e)}static thrown(e){if(e instanceof _)return e.get_native();if(e instanceof Error)return e;return new d(e)}}_.__name__=!0;class d extends _{constructor(e,t,n){super(String(e),t,n),this.value=e}unwrap(){return this.value}}d.__name__=!0;class m{constructor(e){switch(e){case".":case"..":return this.dir=e,void(this.file="")}let t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");t<n?(this.dir=i.substr(e,0,n),e=i.substr(e,n+1,null),this.backslash=!0):n<t?(this.dir=i.substr(e,0,t),e=i.substr(e,t+1,null)):this.dir=null;let s=e.lastIndexOf(".");-1!=s?(this.ext=i.substr(e,s+1,null),this.file=i.substr(e,0,s)):(this.ext=null,this.file=e)}static directory(e){let t=new m(e);return null==t.dir?"":t.dir}static join(e){let t=[],n=0;for(;n<e.length;){let s=e[n];++n,null!=s&&""!=s&&t.push(s)}if(0==t.length)return"";let s=t[0],r=1,i=t.length;for(;r<i;)s=m.addTrailingSlash(s),s+=t[r++];return m.normalize(s)}static normalize(e){let t="/";if((e=e.split("\\").join(t))==t)return t;let n=[],s=0,r=e.split(t);for(;s<r.length;){let t=r[s];++s,".."==t&&n.length>0&&".."!=n[n.length-1]?n.pop():""==t?(n.length>0||47==i.cca(e,0))&&n.push(t):"."!=t&&n.push(t)}let a="",l=!1,c=!1,u=0,o=n.join(t);for(;u<o.length;){let e=o,t=u++,n=e.charCodeAt(t);n>=55296&&n<=56319&&(n=n-55232<<10|1023&e.charCodeAt(t+1));n>=65536&&++u;let s=n;switch(s){case 47:if(l){let e=s;l=!1,c&&(a+="/",c=!1),a+=String.fromCodePoint(e)}else c=!0;break;case 58:a+=":",l=!0;break;default:let e=s;l=!1,c&&(a+="/",c=!1),a+=String.fromCodePoint(e)}}return a}static addTrailingSlash(e){if(0==e.length)return"/";let t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");return t<n?n!=e.length-1?e+"\\":e:t!=e.length-1?e+"/":e}static isAbsolute(e){return!!e.startsWith("/")||(":"==e.charAt(1)||!!e.startsWith("\\\\"))}}m.__name__=!0;class f{constructor(e){this.current=0,this.array=e}hasNext(){return this.current<this.array.length}next(){return this.array[this.current++]}}f.__name__=!0;class p{static __string_rec(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";let n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e.__enum__){let n=s[e.__enum__].__constructs__[e._hx_index],r=n._hx_name;return n.__params__?(t+="\t",r+"("+function(){let s=[];{let r=0,i=n.__params__;for(;r<i.length;){let n=i[r];r+=1,s.push(p.__string_rec(e[n],t))}}return s}().join(",")+")"):r}if(e instanceof Array){let n="[";t+="\t";let s=0,r=e.length;for(;s<r;){let r=s++;n+=(r>0?",":"")+p.__string_rec(e[r],t)}return n+="]",n}let n;try{n=e.toString}catch(e){return"???"}if(null!=n&&n!=Object.toString&&"function"==typeof n){let t=e.toString();if("[object Object]"!=t)return t}let r="{\n";t+="\t";let i=null!=e.hasOwnProperty,a=null;for(a in e)i&&!e.hasOwnProperty(a)||"prototype"!=a&&"__class__"!=a&&"__super__"!=a&&"__interfaces__"!=a&&"__properties__"!=a&&(2!=r.length&&(r+=", \n"),r+=t+a+" : "+p.__string_rec(e[a],t));return r+="\n"+(t=t.substring(1))+"}",r;case"string":return e;default:return String(e)}}}p.__name__=!0;var g=require("fs"),w=require("path"),x=require("buffer").Buffer;class y{static get_packageVersion(){return null==y.packageVersion&&(y.packageVersion="9.0.0"),y.packageVersion}}y.__name__=!0;class b{static assetPath(e){let t=null!=e?e.scss:null;return u.replace(m.join([m.directory(__filename),"../"+(null!=t&&t?"src/mc2it/theme/ui":"www")]),"/","Windows"==o.systemName()?"\\":"/")}static copyAssets(e,t){null==t&&(t={});let n=["css","fonts","img"],s=[],r=0;for(;r<n.length;){let e=n[r];++r;let i=l.field(t,e);null!=i&&i&&s.push(e)}let i=b.assetPath(),a=0,c=s.length>0?s:n;for(;a<c.length;){let t=c[a];++a,b.copyDirectory(m.join([i,t]),1==s.length?e:m.join([e,t]))}}static copyDirectory(e,t){let n=0,s=g.readdirSync(e);for(;n<s.length;){let r=s[n];++n;let i=m.join([e,r]),a=m.join([t,r]);A.isDirectory(i)?b.copyDirectory(i,a):(A.createDirectory(m.directory(a)),F.copy(i,a))}}}e.copyAssets=b.copyAssets,e.assetPath=b.assetPath,b.__name__=!0;class S{constructor(){this.help=!1,this.img=!1,this.fonts=!1,this.css=!1}run(e){if(this.help){let e=(new T).format(C.get());return process.stdout.write(c.string(e)),process.stdout.write("\n"),new $(new Y(ee.Success(null)))}let t="1"==process.env.HAXELIB_RUN;if(e.length<(t?2:1))return new $(new Y(ee.Failure(new G(400,"You must provide the path of the output directory.",{fileName:"src/mc2it/theme/cli/CopyCommand.hx",lineNumber:37,className:"mc2it.theme.cli.CopyCommand",methodName:"run"}))));let n=m.isAbsolute(e[0])?e.shift():m.join([t?e.pop():m.addTrailingSlash(process.cwd()),e.shift()]);return b.copyAssets(n,{css:this.css,fonts:this.fonts,img:this.img}),new $(new Y(ee.Success(null)))}}S.__name__=!0;class k{constructor(){this.help=!1,this.scss=!1}run(){let e=this.help?(new T).format(D.get()):b.assetPath({scss:this.scss});return process.stdout.write(c.string(e)),process.stdout.write("\n"),new $(new Y(ee.Success(null)))}}k.__name__=!0;class v{constructor(){this.version=!1,this.help=!1,this.libpath=new k,this.copy=new S}run(){let e=this.version?y.get_packageVersion():(new T).format(j.get());return process.stdout.write(c.string(e)),process.stdout.write("\n"),new $(new Y(ee.Success(null)))}static main(){process.title="MC2IT Theme",new P(new v,new W(5)).process(process.argv.slice(2)).handle(N.exit)}}v.__name__=!0;class A{static isDirectory(e){try{return g.statSync(e).isDirectory()}catch(e){return!1}}static createDirectory(e){try{g.mkdirSync(e)}catch(t){let n=_.caught(t).unwrap();if("ENOENT"==n.code)A.createDirectory(w.dirname(e)),g.mkdirSync(e);else{let t;try{t=g.statSync(e)}catch(e){throw n}if(!t.isDirectory())throw n}}}}A.__name__=!0;class F{static copy(e,t){let n,s=g.openSync(e,"r"),r=g.fstatSync(s),i=g.openSync(t,"w",r.mode),a=0;for(;n=g.readSync(s,F.copyBuf,0,65536,a),n>0;)g.writeSync(i,F.copyBuf,0,n),a+=n;g.closeSync(s),g.closeSync(i)}}F.__name__=!0;class N{static exit(e){switch(e._hx_index){case 0:process.exit(0);break;case 1:let t=e.failure,n=t.message;null!=t.data&&(n+=", "+(null==t.data?"null":c.string(t.data))),process.stdout.write(c.string(n)),process.stdout.write("\n");let s=t.code;process.exit(s)}}}N.__name__=!0;class E{constructor(e){this.buffer=e}}E.__name__=!0;class C{static get(){return null==C.doc&&(C.doc={doc:"\r\n\tCopy the theme assets to a given directory.\r\n\r\n\t> mc2it_theme copy [flags] <directory>\r\n",commands:[{isDefault:!0,isSub:!1,names:[],doc:" directory : The path to the output directory. "}],flags:[{names:["--css"],aliases:["c"],doc:" Copy only CSS files. "},{names:["--fonts"],aliases:["f"],doc:" Copy only font files. "},{names:["--img"],aliases:["i"],doc:" Copy only image files. "},{names:["--help"],aliases:["h"],doc:" Display this help. "}]}),C.doc}}C.__name__=!0;class D{static get(){return null==D.doc&&(D.doc={doc:"\r\n\tPrint the path to the theme assets.\r\n\r\n\t> mc2it_theme libpath [flags]\r\n",commands:[{isDefault:!0,isSub:!1,names:[],doc:null}],flags:[{names:["--scss"],aliases:["s"],doc:" Print the specific path of SCSS files. "},{names:["--help"],aliases:["h"],doc:" Display this help. "}]}),D.doc}}D.__name__=!0;class j{static get(){return null==j.doc&&(j.doc={doc:"\r\n\tCommand line interface of MC2IT Theme.\r\n\r\n\t> mc2it_theme [flags] <subcommand>\r\n",commands:[{isDefault:!1,isSub:!0,names:["copy"],doc:" Copy the theme assets to a given directory. "},{isDefault:!1,isSub:!0,names:["libpath"],doc:" Print the path to the theme assets. "},{isDefault:!0,isSub:!1,names:[],doc:null}],flags:[{names:["--help"],aliases:["h"],doc:" Display this help. "},{names:["--version"],aliases:["v"],doc:" Output the version number. "}]}),j.doc}}j.__name__=!0;class R{constructor(e,t,n){this.command=e,this.prompt=t,this.hasFlags=n}processArgs(e){let t=this;return this.hasFlags?G.catchExceptions((function(){let n=R.expandAssignments(e),s=[],r=0,a=!1;for(;r<n.length;){let e=n[r];if("--"==e)a=!0,++r;else if(a||45!=i.cca(e,0))s.push(e),++r;else{let s=t.processFlag(n,r);if(-1==s){if(45==i.cca(e,1))throw _.thrown('Unrecognized flag "'+e+'"');{let s=t.processAlias(n,r);if(-1==s)throw _.thrown('Unrecognized alias "'+e+'"');r+=s+1}}else r+=s+1}}return s}),null,{fileName:"tink/cli/Router.hx",lineNumber:25,className:"tink.cli.Router",methodName:"processArgs"}):ee.Success(e)}processFlag(e,t){return-1}processAlias(e,t){return-1}static expandAssignments(e){let t=[],n=!0,s=0;for(;s<e.length;){let r=e[s];if(++s,"--"==r&&(n=!1),n){let e=i.cca(r,0),n=i.cca(r,1),s=r.indexOf("=");null==e?t.push(r):45==e?null==n?t.push(r):45==n&&-1!=s?(t.push(i.substr(r,0,s)),t.push(i.substr(r,s+1,null))):t.push(r):t.push(r)}else t.push(r)}return t}}R.__name__=!0;class I extends R{constructor(e,t){super(e,t,!0)}process(e){let t=this;if(null==e[0]){let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}{let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}}processFlag(e,t){switch(e[t]){case"--css":this.command.css=!0;break;case"--fonts":this.command.fonts=!0;break;case"--help":this.command.help=!0;break;case"--img":this.command.img=!0;break;default:return-1}return t-t}processAlias(e,t){let n=e[t],s=1,r=n.length;for(;s<r;){let e=s++,t=i.cca(n,e);if(null==t)throw _.thrown("Invalid alias '-"+n.charAt(e)+"'");switch(t){case 99:this.command.css=!0;break;case 102:this.command.fonts=!0;break;case 104:this.command.help=!0;break;case 105:this.command.img=!0;break;default:throw _.thrown("Invalid alias '-"+n.charAt(e)+"'")}}return t-t}promptRequired(){return J.async((function(e){e(ee.Success(null))}))}run_run(e){return e.length<0?new $(new Y(ee.Failure(new G(null,"Insufficient arguments. Expected: 0, Got: "+e.length,{fileName:"src/mc2it/theme/cli/CopyCommand.hx",lineNumber:29,className:"tink.cli.Router0",methodName:"run_run"})))):this.command.run(e.slice(0,e.length))}}I.__name__=!0;class q extends R{constructor(e,t){super(e,t,!0)}process(e){let t=this;if(null==e[0]){let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}{let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}}processFlag(e,t){switch(e[t]){case"--help":this.command.help=!0;break;case"--scss":this.command.scss=!0;break;default:return-1}return t-t}processAlias(e,t){let n=e[t],s=1,r=n.length;for(;s<r;){let e=s++,t=i.cca(n,e);if(null==t)throw _.thrown("Invalid alias '-"+n.charAt(e)+"'");switch(t){case 104:this.command.help=!0;break;case 115:this.command.scss=!0;break;default:throw _.thrown("Invalid alias '-"+n.charAt(e)+"'")}}return t-t}promptRequired(){return J.async((function(e){e(ee.Success(null))}))}run_run(e){return this.command.run()}}q.__name__=!0;class P extends R{constructor(e,t){super(e,t,!0)}process(e){let t=this,n=e[0];if(null==n){let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}switch(n){case"copy":return this.run_copy(e.slice(1));case"libpath":return this.run_libpath(e.slice(1));default:let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new $(new Y(ee.Failure(s.failure)))}return te.next(this.promptRequired(),(function(e){return t.run_run(n)}))}}processFlag(e,t){switch(e[t]){case"--help":this.command.help=!0;break;case"--version":this.command.version=!0;break;default:return-1}return t-t}processAlias(e,t){let n=e[t],s=1,r=n.length;for(;s<r;){let e=s++,t=i.cca(n,e);if(null==t)throw _.thrown("Invalid alias '-"+n.charAt(e)+"'");switch(t){case 104:this.command.help=!0;break;case 118:this.command.version=!0;break;default:throw _.thrown("Invalid alias '-"+n.charAt(e)+"'")}}return t-t}promptRequired(){return J.async((function(e){e(ee.Success(null))}))}run_copy(e){return new I(this.command.copy,new W(5)).process(e)}run_libpath(e){return new q(this.command.libpath,new W(5)).process(e)}run_run(e){return this.command.run()}}P.__name__=!0;class T{constructor(e){this.re=new r("^\\s*\\*?\\s{0,2}(.*)$",""),this.root=e}format(e){let t="";t+="\n";let n=this.formatDoc(e.doc);null!=n&&(t+=c.string(n+"\n\n"));let s=e.commands,r=[],i=0;for(;i<s.length;){let e=s[i];++i,e.isDefault||r.push(e)}null!=this.root&&(t+=c.string("  Usage: "+this.root+"\n"));let l=a.find(e.commands,(function(e){return e.isDefault}));if(null!=l){let e=this.formatDoc(l.doc);null!=e&&(t+=c.string(this.indent(e,4)+"\n\n"))}let o=this;if(r.length>0){let e=a.fold(r,(function(e,t){let n=0,s=e.names;for(;n<s.length;){let e=s[n];++n,e.length>t&&(t=e.length)}return t}),0);null!=this.root&&(t+=c.string("  Usage: "+this.root+" <subcommand>\n")),t+=c.string("    Subcommands:\n");let n=function(n,s){null==s&&(s="(doc missing)"),t+=c.string(o.indent(u.lpad(n," ",e)+" : "+u.trim(o.indent(s,e+3)),6)+"\n")},s=0;for(;s<r.length;){let e=r[s];++s;let t=e.names[0];if(n(t,this.formatDoc(e.doc)),e.names.length>1){let s=1,r=e.names.length;for(;s<r;)n(e.names[s++],"Alias of "+t)}}}if(e.flags.length>0){let n=function(e){let t=e.names.join(", ");if(e.aliases.length>0){let n=e.aliases,s=new Array(n.length),r=0,i=n.length;for(;r<i;){let e=r++;s[e]="-"+n[e]}t+=", "+s.join(", ")}return t},s=a.fold(e.flags,(function(e,t){let s=n(e);return s.length>t&&(t=s.length),t}),0),r=function(e,n){null==n&&(n=""),t+=c.string(o.indent(u.lpad(e," ",s)+" : "+u.trim(o.indent(n,s+3)),6)+"\n")};t=(t+="\n")+c.string("  Flags:\n");let i=0,l=e.flags;for(;i<l.length;){let e=l[i];++i,r(n(e),this.formatDoc(e.doc))}}return t}indent(e,t){let n=e.split("\n"),s=new Array(n.length),r=0,i=n.length;for(;r<i;){let e=r++;s[e]=u.lpad(""," ",t)+n[e]}return s.join("\n")}formatDoc(e){if(null==e)return null;let t=e.split("\n"),n=u.trim,s=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++;s[e]=n(t[e])}let a=s;for(;""==a[0];)a=a.slice(1);for(;""==a[a.length-1];)a.pop();let l=new Array(a.length),c=0,o=a.length;for(;c<o;){let e=c++,t=a[e];l[e]=this.re.match(t)?this.re.matched(1):t}return l.join("\n")}}T.__name__=!0;class O{constructor(e,t){this.source=e,this.sink=t}}O.__name__=!0;class M extends O{constructor(){let e=process.stdin,t=null;t={},super(ae.wrap("stdin",e,t.chunkSize,t.onEnd),ie.wrap("stdout",process.stdout))}}M.__name__=!0;class W{constructor(e,t){this.trials=e,this.proxy=null==t?new M:t}}W.__name__=!0;class z{static invoke(e,t){z.depth<500?(z.depth++,e(t),z.depth--):z.defer((function(){e(t)}))}static defer(e){global.setImmediate(e)}}class H{constructor(){}cancel(){let e=this.link;null!=e&&e.cancel()}}H.__name__=!0;class L{constructor(e,t){this.dissolved=!1,this.a=e,this.b=t}cancel(){if(!this.dissolved){this.dissolved=!0;let e=this.a;null!=e&&e.cancel();let t=this.b;null!=t&&t.cancel(),this.a=null,this.b=null}}}L.__name__=!0;class V{constructor(e,t){if(null==e)throw _.thrown("callback expected but null received");this.cb=e,this.list=t}cancel(){if(null!=this.list){let e=this.list;this.cb=null,this.list=null,--e.used<=e.cells.length>>1&&e.compact()}}}V.__name__=!0;class B{constructor(e){B._hx_skip_constructor||this._hx_constructor(e)}_hx_constructor(e){this.disposeHandlers=[],this.f=e}dispose(){let e=this.disposeHandlers;if(null!=e){this.disposeHandlers=null;let t=this.f;this.f=B.noop,t();let n=0;for(;n<e.length;)e[n++]()}}static noop(){}}B.__name__=!0;class U extends B{constructor(e){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(e)}_hx_constructor(e){null==e&&(e=!1),this.onfill=function(){},this.ondrain=function(){},this.busy=!1,this.queue=[],this.used=0;let t=this;super._hx_constructor((function(){t.busy||t.destroy()})),this.destructive=e,this.cells=[]}destroy(){let e=0,t=this.cells;for(;e<t.length;){let n=t[e];++e,n.cb=null,n.list=null}if(this.queue=null,this.cells=null,this.used>0){this.used=0;let e=this.ondrain;z.depth<500?(z.depth++,e(),z.depth--):z.defer(e)}}invoke(e){let t=this;if(z.depth<500){if(z.depth++,null!=t.disposeHandlers)if(t.busy){if(1!=t.destructive){let n=t,s=e,r=function(){n.invoke(s)};t.queue.push(r)}}else{t.busy=!0,t.destructive&&t.dispose();let n=t.cells.length,s=0;for(;s<n;){let n=t.cells[s++];null!=n.list&&n.cb(e)}t.busy=!1,null==t.disposeHandlers?t.destroy():(t.used<t.cells.length&&t.compact(),t.queue.length>0&&t.queue.shift()())}z.depth--}else z.defer((function(){if(null!=t.disposeHandlers)if(t.busy){if(1!=t.destructive){let n=t,s=e,r=function(){n.invoke(s)};t.queue.push(r)}}else{t.busy=!0,t.destructive&&t.dispose();let n=t.cells.length,s=0;for(;s<n;){let n=t.cells[s++];null!=n.list&&n.cb(e)}t.busy=!1,null==t.disposeHandlers?t.destroy():(t.used<t.cells.length&&t.compact(),t.queue.length>0&&t.queue.shift()())}}))}compact(){if(!this.busy)if(0==this.used){this.resize(0);let e=this.ondrain;z.depth<500?(z.depth++,e(),z.depth--):z.defer(e)}else{let e=0,t=0,n=this.cells.length;for(;t<n;){let n=t++,s=this.cells[n];if(null!=s.cb&&(e!=n&&(this.cells[e]=s),++e==this.used))break}this.resize(this.used)}}resize(e){this.cells.length=e}}U.__name__=!0;class G{constructor(e,t,n){null==e&&(e=500),this.isTinkError=!0,this.code=e,this.message=t,this.pos=n,this.exceptionStack=[],this.callStack=[]}static withData(e,t,n,s){return G.typed(e,t,n,s)}static typed(e,t,n,s){let r=new G(e,t,s);return r.data=n,r}static asError(e){return null!=e&&e.isTinkError?e:null}static catchExceptions(e,t,n){try{return ee.Success(e())}catch(e){let s=_.caught(e).unwrap(),r=G.asError(s);return ee.Failure(null==r?null==t?G.withData(null,"Unexpected Error",s,n):t(s):r)}}}G.__name__=!0;class X{constructor(){X._hx_skip_constructor||this._hx_constructor()}_hx_constructor(){}getStatus(){return K.NeverEver}handle(e){return null}eager(){}}X.__name__=!0;class Y{constructor(e){this.value=e}isComputed(){return!0}get(){return this.value}compute(){}}Y.__name__=!0;class $ extends X{constructor(e){super(),this.value=e}getStatus(){return K.Ready(this.value)}handle(e){return z.invoke(e,Z.get(this.value)),null}eager(){this.value.isComputed()||Z.get(this.value)}}$.__name__=!0;class J{static never(){return J.NEVER_INST}static first(e,t){let n=e;switch(n.getStatus()._hx_index){case 3:return t.getStatus()._hx_index,n;case 4:return t;default:switch(t.getStatus()._hx_index){case 3:return t;case 4:return n;default:return new Q((function(n){return new L(e.handle(n),t.handle(n))}))}}}static flatMap(e,t,n){let s=e.getStatus();switch(s._hx_index){case 3:let n=s.result;return new Q((function(e){return t(Z.get(n)).handle((function(t){e(t)}))}));case 4:return J.never();default:return new Q((function(n){let s=new H;return new L(e.handle((function(e){let r=t(e).handle(n),i=s.link;null!=i&&i.cancel(),s.link=r})),s)}))}}static async(e,t){null==t&&(t=!1);let n=J.irreversible(e);return t||n.eager(),n}static irreversible(e){return new Q((function(t){return e(t),null}))}}var K=s["tink.core.FutureStatus"]={__ename__:!0,__constructs__:null,Suspended:{_hx_name:"Suspended",_hx_index:0,__enum__:"tink.core.FutureStatus",toString:n},Awaited:{_hx_name:"Awaited",_hx_index:1,__enum__:"tink.core.FutureStatus",toString:n},EagerlyAwaited:{_hx_name:"EagerlyAwaited",_hx_index:2,__enum__:"tink.core.FutureStatus",toString:n},Ready:(t=function(e){return{_hx_index:3,result:e,__enum__:"tink.core.FutureStatus",toString:n}},t._hx_name="Ready",t.__params__=["result"],t),NeverEver:{_hx_name:"NeverEver",_hx_index:4,__enum__:"tink.core.FutureStatus",toString:n}};K.__constructs__=[K.Suspended,K.Awaited,K.EagerlyAwaited,K.Ready,K.NeverEver];class Q extends X{constructor(e){X._hx_skip_constructor=!0,super(),X._hx_skip_constructor=!1,this._hx_constructor(e)}_hx_constructor(e){this.status=K.Suspended,super._hx_constructor(),this.wakeup=e,this.callbacks=new U(!0);let t=this;this.callbacks.ondrain=function(){if(t.status==K.Awaited){t.status=K.Suspended;let e=t.link;null!=e&&e.cancel(),t.link=null}},this.callbacks.onfill=function(){t.status==K.Suspended&&(t.status=K.Awaited,t.arm())}}getStatus(){return this.status}trigger(e){if(3!=this.status._hx_index){this.status=K.Ready(new Y(e));let t=this.link;this.link=null,this.wakeup=null,this.callbacks.invoke(e),null!=t&&t.cancel()}}handle(e){let t=this.status;if(3==t._hx_index)return z.invoke(e,Z.get(t.result)),null;{let t=this.callbacks;if(null==t.disposeHandlers)return null;{let n=new V(e,t);if(t.cells.push(n),0==t.used++){let e=t.onfill;z.depth<500?(z.depth++,e(),z.depth--):z.defer(e)}return n}}}arm(){let e=this;this.link=this.wakeup((function(t){e.trigger(t)}))}eager(){switch(this.status._hx_index){case 0:this.status=K.EagerlyAwaited,this.arm();break;case 1:this.status=K.EagerlyAwaited}}}Q.__name__=!0;class Z{static get(e){return e.compute(),e.get()}}var ee=s["tink.core.Outcome"]={__ename__:!0,__constructs__:null,Success:(t=function(e){return{_hx_index:0,data:e,__enum__:"tink.core.Outcome",toString:n}},t._hx_name="Success",t.__params__=["data"],t),Failure:(t=function(e){return{_hx_index:1,failure:e,__enum__:"tink.core.Outcome",toString:n}},t._hx_name="Failure",t.__params__=["failure"],t)};ee.__constructs__=[ee.Success,ee.Failure];class te{static next(e,t,n){return J.flatMap(e,(function(e){switch(e._hx_index){case 0:return t(e.data);case 1:return new $(new Y(ee.Failure(e.failure)))}}))}}class ne{}ne.__name__=!0;class se{constructor(){}}se.__name__=!0;class re extends se{constructor(e){super(),this.upcoming=e}}re.__name__=!0;class ie extends ne{constructor(e){super(),this.target=e}static wrap(e,t){return new ie(new ce(e,t))}}ie.__name__=!0;class ae extends re{constructor(e){super(J.async((function(t){e.read().handle((function(n){let s,r=t;switch(n._hx_index){case 0:let t=n.data;s=null==t?ue.End:ue.Link(t,new ae(e));break;case 1:s=ue.Fail(n.failure)}r(s)}))}),!0))}static wrap(e,t,n,s){return new ae(new le(e,t,n,s))}}ae.__name__=!0;class le{constructor(e,t,n,s){this.name=e,this.native=t,this.chunkSize=n;let r=J.async((function(n){t.once("end",(function(){n(ee.Success(null))})),t.once("error",(function(t){n(ee.Failure(new G(null,t.code+" - Failed reading from "+e+" because "+t.message,{fileName:"tink/io/nodejs/WrappedReadable.hx",lineNumber:22,className:"tink.io.nodejs.WrappedReadable",methodName:"new"})))}))}));r.eager(),this.end=r,null!=s&&this.end.handle((function(){process.nextTick(s)}))}read(){let e=this;return J.first(J.async((function(t){let n=null;n=function(){try{let s=e.native.read(e.chunkSize);if(null==s)e.native.once("readable",n);else{let e="string"==typeof s?new x(s):s;t(ee.Success(new E(e)))}}catch(n){let s=_.caught(n).unwrap();t(ee.Failure(G.withData(null,"Error while reading from "+e.name,s,{fileName:"tink/io/nodejs/WrappedReadable.hx",lineNumber:48,className:"tink.io.nodejs.WrappedReadable",methodName:"read"})))}},n()})),this.end)}}le.__name__=!0;class ce{constructor(e,t){this.name=e,this.native=t,this.ended=J.async((function(e){t.once("end",(function(){e(ee.Success(!1))})),t.once("finish",(function(){e(ee.Success(!1))})),t.once("close",(function(){e(ee.Success(!1))})),t.on("error",(function(t){e(ee.Failure(new G(null,t.code+": "+t.message,{fileName:"tink/io/nodejs/WrappedWritable.hx",lineNumber:24,className:"tink.io.nodejs.WrappedWritable",methodName:"new"})))}))}))}}ce.__name__=!0;var ue=s["tink.streams.Step"]={__ename__:!0,__constructs__:null,Link:(t=function(e,t){return{_hx_index:0,value:e,next:t,__enum__:"tink.streams.Step",toString:n}},t._hx_name="Link",t.__params__=["value","next"],t),Fail:(t=function(e){return{_hx_index:1,e:e,__enum__:"tink.streams.Step",toString:n}},t._hx_name="Fail",t.__params__=["e"],t),End:{_hx_name:"End",_hx_index:2,__enum__:"tink.streams.Step",toString:n}};function oe(e){return e instanceof Array?new f(e):e.iterator()}ue.__constructs__=[ue.Link,ue.Fail,ue.End],"undefined"!=typeof performance&&"function"==typeof performance.now&&(i.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),String.__name__=!0,Array.__name__=!0,p.__toStr={}.toString,F.copyBuf=x.alloc(65536),z.depth=0,B._hx_skip_constructor=!1,X._hx_skip_constructor=!1,J.NEVER_INST=new X,v.main()}("undefined"!=typeof exports?exports:globalThis,globalThis);